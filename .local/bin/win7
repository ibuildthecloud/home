#!/bin/bash

#KVM_DISPLAY="-display vnc=127.0.0.1:7"

#sudo kvm -m 1024 -net nic -net user,hostfwd=tcp:127.0.0.1:3389-:3389 -drive file=/dev/sda,if=virtio $KVM_DISPLAY -usbdevice tablet -soundhw hda -rtc base=localtime -smp cores=2 -display none -vga qxl -spice port=9999,password=1234 \

sudo ls
sudo kvm \
    -m 1024 \
    -smp cores=2 \
    -drive file=/dev/sda,if=virtio \
    -usbdevice tablet \
    -soundhw hda \
    -rtc base=localtime \
    -display none \
    -vga qxl \
    -spice port=9999,password=win7 \
    -device virtio-serial-pci,id=virtio-serial0,max_ports=16,bus=pci.0,addr=0x5 \
    -chardev spicevmc,name=vdagent,id=vdagent \
    -device virtserialport,nr=1,bus=virtio-serial0.0,chardev=vdagent,name=com.redhat.spice.0 &

sleep 1
remote-viewer spice://localhost:9999
